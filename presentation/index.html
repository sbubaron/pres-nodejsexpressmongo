<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	
	<title>NodeJS, Express, MongoDB</title>
	
	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css">
	<link rel="stylesheet" href="css/theme/presentation.css">
	
	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">
	
	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
</head>
<body>
	<div class="reveal">
		<div class="slides">
			<section data-background-image="images/title-slide.jpg">
				<h1>Getting Started with NodeJS, Express and MongoDB</h1>
				
			</section>
			<section>
				<h1>NODEJS Stack 101</h1>
				<h2>Prerequisites</h2>
				Step 1: Clone the Repo:<br /> <a href="https://github.com/sbubaron/pres-nodejsexpressmongo">https://github.com/sbubaron/pres-nodejsexpressmongo</a><br /><br />
				Step 2: Install the Stuff In ReadMe
			</section>
			<section>
				<section><h1>A Bit About Your Host</h1><h2>(Shameful Plugs)</h2></section>
				<section>Work for DoIT @ Stony Brook University</section>
				<section>Full Stack Developer <br />Projects in C#/Drupal/Front End Framework</section>
				<section>it.stonybrook.edu</section>
				<section>classie-evals.stonybrook.edu</section>
				<section>Outside of Work</section>
				<section><img style="width: 600px;" src="images/hackfoster.jpg" /><br /><3 Hackathons</section>
				<section><img src="images/liweb.jpeg" /><br /><a href="http://www.meetup.com/li-web">meetup.com/li-web</a><br />Presentations | Social's | Code Sprints<br /><a href="http://www.longisland.codes">www.longisland.codes</a><br /></section>
				<section><img style="width: 600px;" src="images/likick.jpg" /><br /><a href="http://www.li-kick.com">www.li-kick.com</a></section>


			</section>
			
			<section><h1>LAMP vs MEAN</h1>
				<img style="width: 400px;" src="images/mean-lamp.jpg" />
				<br />(Its an angry lamp....get it? /rimshot)
				<aside class="notes">
					<p>The LAMP stack is a popular platform consisting of Linux Apache, MySQL and PHP -- now certainly you can swap in and out pieces you need (WAMP Windows***, LEMP: *nginx** etc, ***Perl/PHP/Python). The focus here revolves mainly around the server side infrastructure and each tool really requires a unique skillset or atleast fairly heavy initial setup and configuration</p>
					<p>The MEAN (Mongo, Express, Angular, Node) stack became popular because it simplified the initial setup and for developers standardized on a single language that could be used across the entire stack (Javascript).</p>
					<p>For this talk we are going to focus on the server side Node, Express and Mongo as the Angular piece itself can easily be substituted for whatever client side framework of your choosing. </p>
				</aside>
			</section>
			
			<section>
				<section>
					<h1>What Exactly is NodeJS?</h1>
				</section>
				<section>
					<blockquote>
						<p>"Node.js is a JavaScript <strong>runtime</strong> built on Chrome's V8 JavaScript <strong>engine</strong>.</p> <p>Node.js uses an <strong>event-driven, non-blocking</strong> I/O model that makes it lightweight and efficient."</p>
					</blockquote>
					<aside class="notes">
						Official definition from nodejs.org 
					</aside>
				</section>
				<section>
					<iframe src="https://giphy.com/embed/wXnkY2L6sxegM" width="473" height="480" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
					<p><a class="small-link" href="https://www.giphy.com">Thanks Giphy!</a></p>
					<aside class="notes">
						Yeah, there was alot of buzz words in that, lets unbox it a bit. 
					</aside>
				</section>
				
				<section>
					
					<h1>JS Engines</h1>
					<p>Parse Javascript and converts it into code that can actually be executed.</p>
					<aside class="notes">
						Chrome V8 JS<br />
						Open Source Engine Developed by Chromium Project<br />
						First Release September 2008<br />
						<br />
						Designed to be Used both in Browser and Standalone<br />
						Single Threaded<br />
						<br />
						Big Users: Chrome/Chromium, Opera, Couchbase DB, NodeJS, Electron<br />
						<br />
						Other engines include: Chakra (IE), SpiderMonkey (Mozilla/Firefox), JavaScriptCore (Safari)<br />
						<br />
						Its because of these different engines and the subtle differences in which they implement the JS Spec that JS behaves differently across browsers. <br />
					</aside>
				</section>
				
				<section>
					
					<h1>JS Runtimes</h1>
					<p>Provide additional objects that JS can interact with.</p>
					<aside class="notes">
						In browsers these objects include the "window" & "dom". <br />
						<br />
						In nodejs these include "require", "buffers" and "process"<br />
						
					</aside>
				</section>
				
				<section>
					
					<h1>Cross-Language</h1>
					<aside class="notes">
						Can be written in JS, CoffeeScript, Dart or TypeScript
					</aside>
				</section>
				<section>
					<h1>Cross-Platform</h1>
					<aside class="notes">
						OSX, Windows, Linux & Unix
					</aside>
				</section>
			</section>
			<section>
				<section>
					<h1>Why was NodeJS Created?</h1>
					<aside class="notes">
						Ryan Dahl was inspired to create Node.js after seeing a file upload progress bar on Flickr. The browser did not know how much of the file had been uploaded and had to query the Web server. Dahl desired an easier way.
						He criticized the limited possibilities of the most popular web server in 2009, Apache HTTP Server, to handle a lot of concurrent connections (up to 10,000 and more) and the most common way of creating code (sequential programming), when code either blocked the entire process or implied multiple execution stacks in the case of simultaneous connections.
						From Wikipedia -- https://en.wikipedia.org/wiki/Node.js
					</aside>
				</section>
				<section>
					yeah but...If NodeJS is Single Threaded...how can it possibly scale better and handle multiple requests simultaneously?
					
				</section>
				<section>
					<iframe src="https://giphy.com/embed/3EV74tm43smVa" width="378" height="480" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
				</section>
				
				<section>
					<img src="images/eventloop.png" />
					
					<aside class="notes">
						<p>Even though V8 is single-threaded, the underlying C++ API of Node isn't. </p>
						<p>Uses libuv to handle asynchronous events -- Libuv is an abstraction layer for network and file system functionality on both Windows and POSIX-based systems like Linux, Mac OS X, OSS on NonStop and Unix.</p>
						<p>When we call something that is a non-blocking operation, Node will call some code that will run concurrently with our javascript code under the hood on its own thread.</p>
						<p>Once that thread either throws an error or gets the data it is waiting for, the provided callback gets called with the appropriate parameters</p>
						<p>IO operations can be orders of magnitude slower than data processing. Take this for example: SSD-s can have a read speed of 200-730 MB/s - at least a high-end one. Reading just one kilobyte of data would take 1.4 microseconds, but during this time a CPU clocked at 2GHz could have performed 28 000 of instruction-processing cycles.</p>
						https://nodejs.org/en/docs/guides/blocking-vs-non-blocking/<br />
						https://www.tutorialspoint.com/nodejs/nodejs_event_loop.htm<br />
						https://nodesource.com/blog/understanding-the-nodejs-event-loop<br />
						
						
					</aside>
				</section>
			</section>
			
			<section>
				<section><h1>Helloooo World</h1>
					<p>It's Time to Start Getting Our Hands Dirty</p></section>
					<section><img src="images/nodev.jpg" /></section>
					<section>Explore The Code</section>
				</section>
				<section>
					<section><h1>Awesome...<br />...but uh...<br />...now what?</h1>
					</section>
					<section>
						<h1>Let's Power Up Our Tooling</h1>
						<iframe src="https://giphy.com/embed/103ZH3eKKKCKo8" width="480" height="260" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
						<aside class="notes">
							We're going to get into a more meaty example, but fist, lets power up our tooling...
						</aside>
						
					</section>
					
					<section>
						<img src="images/nodemon.jpg" />
					</section>
				</section>
				<section>
					<section>
						<h1>General Coding Best Practices</h1>
					</section>
					<section>
						<p>Keep in Mind the Concept of Separations of Concerns</p>
						<aside class="notes">
							Write & Use Small Reusable, Testable Modules<br /><br />
							The best code is often times no (or less code).<br /><br />
							The more you can reuse, the less you have to test.<br /><br />
						</aside>
					</section>
					
					<section>
						<p>Don’t Reinvent the Wheel; Reuse often</p>
					</section>
					<section>
						<p>Don’t Manage External Dependencies By Hand <br />& Don't Commit "Compiled Code"</p>
						<aside class="notes">
							Source control works best on "source", and while external dependcies can sometimes be source, its best to manage them separate from our own code so we can more easily upgrade or swap them in and out. 
						</aside>
					</section>
					
					<section>
						<p>Dev Team should all use same versions of libraries</p>
						<aside class="notes">
							One of the biggest issues with the LAMP stack was mirroring your dev environment with production and keeping development environments across all developers in sync easily. 
						</aside>
					</section>
					
					
					
				</section>
				<section>
					<section><h1>NPM & Package Management</h1></section>
					<section>Node.js' package ecosystem, npm, is the <strong>largest collection</strong> of open source libraries in the world.</section>
					<section>Developers list modules they need in package.json -- modules can either be marked as required for production or just for development</section>
					<section>Developers can choose specific versions or specify rules about what versions they want</section>
					<section>Package.json gets committed to repo, while modules themselves stay out. During deployment or dev setup, just run npm install to get the right packages.</section>
					<section>Handles the complexities of the dependency chain </section>
					
					
				</section>
				<section>
					<section><h1>MVC</h1></section>
					<section>
						<blockquote>"At the heart of MVC ... is to make a clear division between domain objects that model our perception of the real world, and presentation objects that are the GUI elements we see on the screen." -- Martin Fowler</blockquote>
					</section>
					<section>
						<img src="images/mvc.jpg" />
						<aside class="notes">
							Models define our "real world objects"<br /><br />
							Routes forward the supported requests (and any information encoded in request URLs) to the appropriate controller functions.<br /><br />
							Controller functions to get the requested data from the models, create an HTML page displaying the data, and return it to the user to view in the browser.<br /><br />
							Views (templates) used by the controllers to render the data.<br /><br />
							
							
						</aside>
					</section>
					
					
				</section>
				<section>
					<section><h1>What is Express?</h1></section>
					<section>Lightly Opinionated Framework on top of Node to help build Web Apps & API’s</section>
					<section>“De-Facto Standard Web Server for Node Apps”</section>
					<section>Reduces Amount of Code Needed</section>
					<section>Helps manage routes & handling of requests and views</section>
					<section>Supports many different template engines including Jade and Embedded JS</section>
					<section>Install Express Generator
						<img style="width: 900px" src="images/express-install.jpg" />
					</section>
					<section>Explore The Code</section>
				</section>
				<section>
					<section><h1>Awesome...<br />...but uh...<br />...now what?</h1></section>
				</section>
				<section>
					<section><h1>Dealing With Data</h1></section>
				</section>
				<section>
					<section>			<h2>Relational DBs</h2> 		</section>
					<section>Data Organized into one or more tables</section>
					<section>Tables consists of rows (records) and columns (fields)</section>
					<section>Each row identified by a key</section>
					<section>Can join data from different tables through keys</section>
					<section>Data is queried, created, updated and deleted using SQL</section>
					<section>...And this is great if</section>
					<section>Your data is highly and consistently structured</section>
					<section>Your data has relationships between each other</section>
					
					<section>You Need ACID transactional consistency
						<aside class="notes">
							In computer science, ACID (Atomicity, Consistency, Isolation, Durability) is a set of properties of database transactions intended to guarantee validity even in the event of errors, power failures, etc. In the context of databases, a sequence of database operations that satisfies the ACID properties, and thus can be perceived as a single logical operation on the data, is called a transaction. For example, a transfer of funds from one bank account to another, even involving multiple changes such as debiting one account and crediting another, is a single transaction.<br /><br />
							Atomic = All or nothing, if one part fails the entire transaction fails<br /><br />
							Consistency = Any transaction will bring the datbase from one valid state to another valid Started<br /><br />
							Isolation = esures concurrent execution of transactions results in a system state that would be obtained if transactions were executed sequentially<br /><br />
							Durability = once a transaction has been committed, it will remain so, even in the event of power loss, crashes, or errors.<br /><br />
							https://en.wikipedia.org/wiki/ACID
						</aside>
					</section>
					<section>Your Data is Easily Normalized</section>
					<section>But...We know that data can be moody</section>
					
					
					<section><iframe src="https://giphy.com/embed/3o7TKEJDLnrpqu11ni" width="480" height="330" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></section>
					<section>Complex Data Can Be Hard To Model</section>
					<section>Maybe you have semi-structured data</section>
					<section>You May Experience Performance problems associated with re-assembling simple data structures into their more complicated real-world representations. </section>
					<section>It's a pain mapping Objects to their Data Model Representation</section>
				</section>
				<section>
					<section><h1>Non-Relational Databases</h1></section>
					<section>
						Key-Value Stores
						<aside class="notes">
							<p>These databases pair keys to values.  An analogy is a files system where the path acts as the key and the contents act as the file.  There are usually no fields to update, instead, the entire value other than the key must be updated if changes are to be made. Super Simple</p>
							Redis, Memcache<br /><br />
							http://www.jamesserra.com/archive/2015/04/types-of-nosql-databases/
						</aside>
					</section>
					<section>Graph Stores
						<aside class="notes">
							<p>Graph stores – These excel at dealing with interconnected data.  Graph databases consist of connections, or edges, between nodes.  Both nodes and their edges can store additional properties such as key-value pairs -- Difficult to scale</p>
							Neo4J<br /><br />
							http://www.jamesserra.com/archive/2015/04/types-of-nosql-databases/
						</aside>
						
					</section>
					<section>Column Stores
						<aside class="notes">
							<p>Column stores – Relational databases store all the data in a particular table’s rows together on-disk, making retrieval of a particular row fast.  Column-family databases generally serialize all the values of a particular column together on-disk, which makes retrieval of a large amount of a specific attribute fast -- Great for aggregate queries</p>
							Cassandra<br /><br />
							http://www.jamesserra.com/archive/2015/04/types-of-nosql-databases/
						</aside>
						
					</section>
					<section>Document Stores
						<aside class="notes">
							<p>Document stores – These databases store records as “documents” where a document can generally be thought of as a grouping of key-value pairs (it has nothing to do with storing actual documents such as a Word document).  Keys are always strings, and values can be stored as strings, numeric, Booleans, arrays, and other nested key-value pairs.  Values can be nested to arbitrary depths.  In a document database, each document carries its own schema — unlike an RDBMS, in which every row in a given table must have the same columns</p>
							MongoDB, CouchDB, Firebase, DocumentDB
							http://www.jamesserra.com/archive/2015/04/types-of-nosql-databases/
						</aside>
						
					</section></section>
					<section>
						<section><h1>MongoDB</h1></section>
						<section>Documents Are Stored In Collections</section>
						<section>Documents are Stored As Sweet Sweet JSON</section>
						<section>Flexible Data Model</section>
						<section>Immune to SQL Injection Attacks</section>
						<section>Application Flow / Control is Code Side</section>
						<section>
							...but remember..
						</section>
						<section>In general there are less saftey nets</section>
						<section>Not Fully ACID</section>
						<section>Limited Support for joins</section>
						<section>Data is denormalized, which may mean large / bulk updates</section>
						<section>Does not have built in Data Integrity</section>
						<section>MongoDB comes without any default authentication</section>
						
						<section>
							<h2>Installing MongoDB</h2>
							<a href="https://www.mongodb.com/download-center?jmp=tutorials#community">https://www.mongodb.com/download-center?jmp=tutorials#community</a>
						</section>
					</section>
					<section>
						<section><h1>Mongoose</h1></section>
						<section><iframe src="https://giphy.com/embed/eyoXAcPzQyKA0" width="480" height="324" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><br />
							Mongooses? Mongoosens? Mongeeses? <br />I dunno...but they kick ass</section>
							<section>Object Document Mapper for Mongo</section>
							<section>Define Objects with a Strongly Typed Schema
								<aside class="notes">
									Types include: String, Number, Date, Buffer, Boolean, Mixed, ObjectId, Array
								</aside>
							</section>
							<section>Provides Mechanisms for Data Validation
								<aside class="notes">
									Data Validation Includes: a default value, a custom validation function, indicate a field is required, a get function that allows you to manipulate the data before it is returned as an object, a set function that allows you to manipulate the data before it is saved to the database, minimums, maximums, case transforms, trims, regular expressions and enums
								</aside>
							</section>
						</section>
						<section>
							<section><h1>API's</h1></section>
							<section><img src="images/api-all-the-things.jpeg" /></section>
							<section>Getting Some REST
								<aside class="notes">
									REST is an alternative to other patterns like Remote Procedure Calls, Message Queues and GraphQL<br /><br />
									Resources (or objects/models) are exposed, created, modified or deleted through unique URI endpoints and HTTP Method calls	<br />						
								</aside>
							</section>
							<section>Architectural Design Pattern for Constructing Web API</section>
							<section>Resource-Based Interfaces</section>
							<section>Each Resource has a Defined URI End Point</section>
							<section>CRUD Operations Align with HTTP Methods</section>
							<section>
								<p>
									<strong>GET</strong> is used to fetch data from a server — <strong>Read</strong>
								</p>
								<p>
									<strong>POST</strong> is used to send data to a server — <strong>Create</strong>
								</p>
								
								<p>
									<strong>PUT</strong> is used to send and update data <strong>Replace/Update</strong>
								</p>
								<p>
									<strong>PATCH</strong> is used to send and update data <strong>Partial Update</strong>
								</p>
								<p>
									<strong>DELETE</strong> is used to delete data — <strong>Delete</strong>
								</p>
								
								<aside class="notes">
									Now, these are more "guidelines" the REST God's won't smite you if you implement updates using POST or only support PUT, or modify the way they work.
									Provided you are consistent.
								</aside>
							</section>
						</section>
						<section>
							<section>The Six Principles of a REST API</section>
							
							<section>1. Client server
								<aside class="notes">
									By separating the user interface concerns from the data storage concerns, we improve the portability of the user interface across multiple platforms and improve scalability by simplifying the server components.<br /><br />
								</aside>
							</section>
							<section>2. Stateless
								<aside class="notes">
									Each request from client to server must contain all of the information necessary to understand the request, and cannot take advantage of any stored context on the server. Session state is therefore kept entirely on the client.
								</aside>
							</section>
							<section>3. Cacheable
								<aside class="notes">
									Cache constraints require that the data within a response to a request be implicitly or explicitly labeled as cacheable or non-cacheable. If a response is cacheable, then a client cache is given the right to reuse that response data for later, equivalent requests.
								</aside>
							</section>
							<section>4. Uniform Interface
								<aside class="notes">
									the same shape of request which is made against a particular resource can reasonably be expected to act the same way against another resource (for instance, the request modifying an attribute on a Photo resource is uniform to that of modifying a similar attribute on an Album resource).
								</aside>
							</section>
							<section>5. Layered System
								<aside class="notes">
									The layered system style allows an architecture to be composed of hierarchical layers by constraining component behavior such that each component cannot “see” beyond the immediate layer with which they are interacting.
								</aside>
							</section>
							<section>6. Code on Demand (Optional)
								<aside class="notes">
									REST allows client functionality to be extended by downloading and executing code in the form of applets or scripts. This simplifies clients by reducing the number of features required to be pre-implemented.
								</aside>
							</section>
							
						</section>
						<section>
							<section>
								<h1>We At a Hackathon</h1>
								<iframe src="https://giphy.com/embed/10PcMWwtZSYk2k" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>	
							</section>
							<section>So we'll be <em>"RESTful"</em></section>
							
							<section>To the Code!</section>
						</section>
						<section>
						<section><h1>Awesome...<br />...but uh...<br />...now what?</h1>
						</section>
						<section>The End</section>
						<section>Bonus Scenes</section>
						<section>Subdocuments</section>
						<section>More Advanced Queries in Mongoose</section>
						<section>// With a JSON doc<br />
								Person.<br />
								  find({<br />
									occupation: /host/,<br />
									'name.last': 'Ghost',<br />
									age: { $gt: 17, $lt: 66 },<br />
									likes: { $in: ['vaporizing', 'talking'] }<br />
								  }).<br />
								  limit(10).<br />
								  sort({ occupation: -1 }).<br />
								  select({ name: 1, occupation: 1 }).<br />
								  exec(callback);<br />
								  <br />
						</section>
						<section>
								// Using query builder
								Person.
								  find({ occupation: /host/ }).
								  where('name.last').equals('Ghost').
								  where('age').gt(17).lt(66).
								  where('likes').in(['vaporizing', 'talking']).
								  limit(10).
								  sort('-occupation').
								  select('name occupation').
								  exec(callback);</section>
						<section>ES6 & NodeJS<br /><a href="https://scotch.io/tutorials/better-node-with-es6-pt-i">https://scotch.io/tutorials/better-node-with-es6-pt-i</a></section>
						<section>Javascript Promises<br /><a href="https://www.promisejs.org/">https://www.promisejs.org/</a></section>
						<section>Authentication  JWT/Passport<br /><a href="https://www.djamware.com/post/5a878b3c80aca7059c142979/securing-mean-stack-angular-5-web-application-using-passport?utm_campaign=shareaholic&utm_medium=reddit&utm_source=news">These URL's are too darn long</a></section>
						<section>Swagger<br /><a href="https://github.com/swagger-api/swagger-node">https://github.com/swagger-api/swagger-node</a></section>
						<section>Testing<br /><a href="https://scotch.io/tutorials/test-a-node-restful-api-with-mocha-and-chai">https://scotch.io/tutorials/test-a-node-restful-api-with-mocha-and-chai</a></section>
						

					</section>
					<section>
						<h1>Secret Code: NodeExMong81</h1>
					</section>
					</div>
				</div>
				
				<script src="lib/js/head.min.js"></script>
				<script src="js/reveal.js"></script>
				
				<script>
					// More info about config & dependencies:
					// - https://github.com/hakimel/reveal.js#configuration
					// - https://github.com/hakimel/reveal.js#dependencies
					Reveal.initialize({
						progress: true,
						history: true,
						slideNumber: false,
						dependencies: [
						{ src: 'plugin/markdown/marked.js' },
						{ src: 'plugin/markdown/markdown.js' },
						{ src: 'plugin/notes/notes.js', async: true },
						{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
						]
					});
				</script>
			</body>
			</html>
			